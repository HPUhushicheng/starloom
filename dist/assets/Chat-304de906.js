import{T as e,_ as t,d as a,g as s,l as n,h as o,a as l,e as i,b as r,c,i as u,m as p,n as d,f as h,j as g,o as m,p as A,r as y,s as v,q as D,k}from"./TextComponents-c767e558.js";import{r as C,u as b,k as w,j as T,c as f,O as x,b as S,e as I,t as R,F as K,g as L,f as B,n as E,o as N,h as U,Q as O}from"./vandor-21099042.js";import{_ as q,g as G,d as j}from"./index-bd5e3691.js";const H={class:"topDiv"},Q={class:"chatListbox"},V={key:0,class:"question"},F={class:"text-content"},J={class:"inner"},W={key:0},z=["src"],Y={key:0,src:j,alt:""},$={key:1,class:"answer"},P={class:"BotHeader"},X={key:0},M={class:"text-content"},Z=["innerHTML"],_={class:"xian"};const ee=q({name:"Chat",setup(){const e=C([]),t=C(""),a=C(!1),s=C(""),n=C("1"),o=C(""),l=C(null),i=b(),r=w(),c=T();let u=r.params.shareKey;const p=()=>{var e=l.value;e.scrollTop=e.scrollHeight},d=f((()=>i.state.screenWidth)),h=f((()=>i.state.loginStatus)),g=async a=>{const s=await G({code:a});if(200==s.code)return e.value=s.data.contents,void(t.value=new Date(parseInt(s.data.time)).toLocaleString().replace(/:d(1,2)$/," "))};return x((()=>{g(u)})),{chatList:e,loading:a,step:n,showText:o,chatContent:l,sendMessage:async(t,l)=>{if(a.value||""==t)return;const r={role:"user",content:t};if(e.value.push(r),a.value=!0,n.value=1,setTimeout((()=>{p(),i.commit("setQuestion","")}),50),l){if("preset1"==l.type)try{const t=await getKlineInfo({code:l.code});if(200==t.code){const a={role:"assistant",content:t.data,type:"preset1"};e.value.push(a)}a.value=!1}catch(c){}else if("preset2"==l.type)try{const t=await getPresetTwo({code:l.code});if(200==t.code){const a={role:"assistant",content:t.data,type:"preset2"};e.value.push(a)}a.value=!1}catch(c){}else if("preset3"==l.type)try{const t=await getData({coin:"ETH"});if(200==t.code){const a={role:"assistant",content:t.data,type:"preset2"};e.value.push(a)}a.value=!1}catch(c){}}else try{const t=await mpcbot({content:e.value,sourceFlag:"widget",sourceType:"H5",equipmentNo:"0xcef7e44d13286e23782e12d654455f"});800==t.resCode?(o.value=t.data.content,n.value=2,s.value="text"):(a.value=!1,n.value=3)}catch(u){a.value=!1,n.value=3}},scrollToBottom:p,chatType:s,screenWidth:d,time:t,getChatList:g,goIndex:()=>{c.push({name:"index"})},addChatHandle:()=>{"Chats"!=s.value&&i.commit("setChatType","Chats");const e=(new Date).getTime()+localStorage.getItem("userId");c.push({path:`/askDivination/${e}`,query:{type:"newChat"}})},continueChatting:()=>{if(h.value){"Chats"!=s.value&&i.commit("setChatType","Chats");const t=e.value[0].msggroup;c.push({path:`/askDivination/${t}`})}else{localStorage.setItem("shareChatList",JSON.stringify(e.value));const t=(new Date).getTime()+localStorage.getItem("userId");c.push({path:`/askDivination/${t}`,query:{type:"continueChat"}})}},loginStatus:h}},components:{TextComponents:e},methods:{onComplete(e){const t=this,a={role:"assistant",content:e,type:"text"};t.chatList.push(a),t.loading=!1,setTimeout((()=>{t.step=3}),100)},regenerateResponse(){const e=this.chatList.filter((e=>"user"==e.role));this.sendMessage(e[e.length-1].content);const t=this;setTimeout((()=>{t.scrollToBottom()}),500)},stop(){this.$refs.TextComponents.stop()}},mounted(){}},[["render",function(e,C,b,w,T,f){const x=a,q=s,G=n,j=o,ee=l,te=i,ae=r,se=c,ne=u,oe=p,le=d,ie=h,re=g,ce=m,ue=A,pe=y,de=v,he=D,ge=k;return N(),S("div",{class:E(["chat",w.screenWidth<=900?"mb-chat":""]),ref:"chatContent"},[I("div",H,[I("div",null,R(e.$t("shareConversation"))+R(w.time),1),I("div",{class:"try",onClick:C[0]||(C[0]=(...e)=>w.goIndex&&w.goIndex(...e))},R(e.$t("trynow")),1)]),I("div",Q,[(N(!0),S(K,null,L(w.chatList,((a,s)=>(N(),S(K,{key:s},["text"==a.showtype||"gpt"==a.showtype||"text"==a.type||"user"==a.role?(N(),S("div",{key:0,class:E(["chat-list","user"==a.role?"right-content":""])},["user"==a.role?(N(),S("div",V,[I("div",F,[I("div",J,[1==a.base64_type&&a.base64_content?(N(),S("div",W,[I("img",{src:a.base64_content,alt:""},null,8,z)])):U("",!0),B(" "+R(a.content),1)])]),w.screenWidth>900?(N(),S("img",Y)):U("",!0)])):U("",!0),"assistant"==a.role?(N(),S("div",$,[I("div",P,[I("img",{class:E(["avatar",w.screenWidth<=900?"mbImg":""]),src:t,alt:""},null,2),w.screenWidth<=900?(N(),S("div",X,R(e.$t("starloom")),1)):U("",!0)]),I("div",M,[I("div",{class:"inner",innerHTML:a.content},null,8,Z)])])):U("",!0)],2)):U("",!0),"assistant"==a.role&&"tem"==a.showtype?(N(),S(K,{key:1},["a-1"==a.submodel?(N(),O(x,{key:0,presetData:a.content},null,8,["presetData"])):U("",!0),"a-2"==a.submodel?(N(),O(q,{key:1,presetData:a.content},null,8,["presetData"])):U("",!0),"a-3"==a.submodel?(N(),O(G,{key:2,presetData:a.content},null,8,["presetData"])):U("",!0),"a-4"==a.submodel?(N(),O(j,{key:3,presetData:a.content},null,8,["presetData"])):U("",!0),"a-5"==a.submodel?(N(),O(ee,{key:4,presetData:a.content,index:s,onChageTab:e.chageTab},null,8,["presetData","index","onChageTab"])):U("",!0),"a-6"==a.submodel?(N(),O(te,{key:5,presetData:a.content},null,8,["presetData"])):U("",!0),"a-7"==a.submodel&&1==a.questionType?(N(),O(ae,{key:6,presetData:a.content,page:e.rankPage,index:s,onChageRankTab:e.chageRankTab,onGetXingzuoRanking:e.getXingzuoRanking},null,8,["presetData","page","index","onChageRankTab","onGetXingzuoRanking"])):U("",!0),"a-7"==a.submodel&&2==a.questionType?(N(),O(se,{key:7,presetData:a.content},null,8,["presetData"])):U("",!0),"a-8"==a.submodel?(N(),O(ne,{key:8,presetData:a.content},null,8,["presetData"])):U("",!0),"assistant"==a.role&&"tem"==a.showtype&&"a-9"==a.submodel?(N(),O(oe,{key:9,presetData:a.content},null,8,["presetData"])):U("",!0),"assistant"==a.role&&"tem"==a.showtype&&"a-10"==a.submodel?(N(),O(le,{key:10,presetData:a.content},null,8,["presetData"])):U("",!0),"assistant"==a.role&&"tem"==a.showtype&&"a-11"==a.submodel?(N(),O(ie,{key:11,presetData:a.content},null,8,["presetData"])):U("",!0),"assistant"==a.role&&"tem"==a.showtype&&"a-12"==a.submodel?(N(),O(re,{key:12,presetData:a.content},null,8,["presetData"])):U("",!0),"assistant"==a.role&&"tem"==a.showtype&&"a-13"==a.submodel?(N(),O(ce,{key:13,presetData:a.content},null,8,["presetData"])):U("",!0),"assistant"==a.role&&"tem"==a.showtype&&"a-14"==a.submodel?(N(),O(ue,{key:14,presetData:a.content},null,8,["presetData"])):U("",!0),"assistant"==a.role&&"tem"==a.showtype&&"a-17"==a.submodel?(N(),O(pe,{key:15,presetData:a.content},null,8,["presetData"])):U("",!0),"assistant"==a.role&&"tem"==a.showtype&&"a-18"==a.submodel?(N(),O(de,{key:16,presetData:a.content},null,8,["presetData"])):U("",!0),"assistant"==a.role&&"tem"==a.showtype&&"a-15"==a.submodel?(N(),O(he,{key:17,presetData:a.content},null,8,["presetData"])):U("",!0),"assistant"==a.role&&"tem"==a.showtype&&"a-16"==a.submodel?(N(),O(ge,{key:18,presetData:a.content},null,8,["presetData"])):U("",!0)],64)):U("",!0)],64)))),128))]),I("div",_,R(e.$t("ContinueOnStarloom")),1),I("div",{class:E(["bottomDiv",w.screenWidth<=900?"mb":""])},[I("div",{class:"noLogin",onClick:C[1]||(C[1]=(...e)=>w.continueChatting&&w.continueChatting(...e))},[C[3]||(C[3]=I("img",{src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABoAAAAaCAYAAACpSkzOAAAAAXNSR0IArs4c6QAAAOJJREFUSEvt1LFqAkEUheH/dBYWvoFbWPgWBlKYxgdJIUFS2CRgwMLCwjaldYo84gkDBjTo3iEzLAg7zRZz4dt77t0VHR115NBD/076PqKzPQYeJB2jVos6sv0K7IGDpFUbVgoNgG/gKcKKoNSB7SysGMrFqkA52AVkew00kp5tPwJvwAJI8XwBo2C7Ut30VLOV9P5b/xd6ASaSlrZnZ9DwNPT0bDvn0EbSx1Uo+hba7qOlqDKjCEkvWAzlIMVQLlIDSlu6i/4KNaAGmEv6jBapeEYRUH29I7DvKEro5n1n0f0AN4dOGwT1jzAAAAAASUVORK5CYII=",alt:"",srcset:""},null,-1)),B(" "+R(e.$t("continueChatting")),1)]),I("div",{class:"addBtn",onClick:C[2]||(C[2]=(...e)=>w.addChatHandle&&w.addChatHandle(...e))},[C[4]||(C[4]=I("img",{src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAAAXNSR0IArs4c6QAAAKNJREFUOE/tk7ENwjAURN9JiAFYADEEO7AEoqGmZQgyAg1iCpZgBCoqSuqgQxFGgg9RXFhKE5dn/2f/fz5ReKkwj36AtidALene1VHWC23vG5CkdSngMQGXA/BnAl+mJDe3wDicXAAGTkGvgZ2k21uPwClQAaNQOAcewDnozSUbSde/wDYHbQ8ut3/v3OgdUlJWpZIye0VZlyLALsjnflbLvQKfYIJBFVJKDxgAAAAASUVORK5CYII=",alt:""},null,-1)),B(" "+R(e.$t("addChat")),1)])],2)],2)}],["__scopeId","data-v-0b9045a7"]]);export{ee as default};
